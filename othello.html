<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oxygen">
<link href='https://fonts.googleapis.com/css?family=Odibee Sans' rel='stylesheet'>
<div class="nav">
  <input type="checkbox" id="nav-check">
  <div class="nav-header">
    <div class="nav-title">
      Game Impulse
    </div>
  </div>
  <div class="nav-btn">
    <label for="nav-check">
      <span></span>
      <span></span>
      <span></span>
    </label>
  </div>
  <style>
    * {
  box-sizing: border-box;
}



.nav {
   height: 52px;
  width: 100%;
  background-color: #582C56;
  position: relative;
}

.nav > .nav-header {
  display: inline;
}

.nav > .nav-header > .nav-title {
  display: inline-block;
  font-size: 22px;
  color: #fff;
  padding: 10px 10px 10px 10px;
}

.nav > .nav-btn {
  display: none;
}

.nav > .nav-links {
  display: inline;
  float: right;
  font-size: 18px;
}

.nav > .nav-links > a {
  display: inline-block;
  padding: 13px 10px 13px 10px;
  text-decoration: none;
  color: #efefef;
}

.nav > .nav-links > a:hover {
  background-color: rgba(0, 0, 0, 0.3);
}

.nav > #nav-check {
  display: none;
}

@media (max-width:600px) {
  .nav > .nav-btn {
    display: inline-block;
    position: absolute;
    right: 0px;
    top: 0px;
  }
  .nav > .nav-btn > label {
    display: inline-block;
    width: 50px;
    height: 50px;
    padding: 13px;
  }
  .nav > .nav-btn > label:hover,.nav  #nav-check:checked ~ .nav-btn > label {
    background-color: rgba(0, 0, 0, 0.3);
  }
  .nav > .nav-btn > label > span {
    display: block;
    width: 25px;
    height: 10px;
    border-top: 2px solid #eee;
  }
  .nav > .nav-links {
    position: absolute;
    display: block;
    width: 100%;
    background-color: #333;
    height: 0px;
    transition: all 0.3s ease-in;
    overflow-y: hidden;
    top: 50px;
    left: 0px;
  }
  .nav > .nav-links > a {
    display: block;
    width: 100%;
  }
  .nav > #nav-check:not(:checked) ~ .nav-links {
    height: 0px;
  }
  .nav > #nav-check:checked ~ .nav-links {
    height: calc(100vh - 50px);
    overflow-y: auto;
  }
  p{
    font-family: "Oxygen";
    font-size: 200px;
  }
}
</style>
<title>Othello</title>
  <div class="nav-links">
    <a href="card.html">Card Games</a>
    <a href="board.html">Board Games</a>
    <a href="word.html" >Word Games</a>
    <a href="arcade.html" >Arcade Games</a>
    <a href="index.html" >Welcome</a>
  </div>
</div>
<br>
<div class="container">
  <div class="container-center">
    <div class="board">
      <table class="board-cells" border="1" bordercolor="#000">
        <tbody>
          <tr>
            <td class="cell" id="cell-0-0"></td>
            <td class="cell" id="cell-0-1"></td>
            <td class="cell" id="cell-0-2"></td>
            <td class="cell" id="cell-0-3"></td>
            <td class="cell" id="cell-0-4"></td>
            <td class="cell" id="cell-0-5"></td>
            <td class="cell" id="cell-0-6"></td>
            <td class="cell" id="cell-0-7"></td>
          </tr>
          <tr>
            <td class="cell" id="cell-1-0"></td>
            <td class="cell" id="cell-1-1"></td>
            <td class="cell" id="cell-1-2"></td>
            <td class="cell" id="cell-1-3"></td>
            <td class="cell" id="cell-1-4"></td>
            <td class="cell" id="cell-1-5"></td>
            <td class="cell" id="cell-1-6"></td>
            <td class="cell" id="cell-1-7"></td>
          </tr>
          <tr>
            <td class="cell" id="cell-2-0"></td>
            <td class="cell" id="cell-2-1"></td>
            <td class="cell" id="cell-2-2"></td>
            <td class="cell" id="cell-2-3"></td>
            <td class="cell" id="cell-2-4"></td>
            <td class="cell" id="cell-2-5"></td>
            <td class="cell" id="cell-2-6"></td>
            <td class="cell" id="cell-2-7"></td>
          </tr>
          <tr>
            <td class="cell" id="cell-3-0"></td>
            <td class="cell" id="cell-3-1"></td>
            <td class="cell" id="cell-3-2"></td>
            <td class="cell" id="cell-3-3"></td>
            <td class="cell" id="cell-3-4"></td>
            <td class="cell" id="cell-3-5"></td>
            <td class="cell" id="cell-3-6"></td>
            <td class="cell" id="cell-3-7"></td>
          </tr>
          <tr>
            <td class="cell" id="cell-4-0"></td>
            <td class="cell" id="cell-4-1"></td>
            <td class="cell" id="cell-4-2"></td>
            <td class="cell" id="cell-4-3"></td>
            <td class="cell" id="cell-4-4"></td>
            <td class="cell" id="cell-4-5"></td>
            <td class="cell" id="cell-4-6"></td>
            <td class="cell" id="cell-4-7"></td>
          </tr>
          <tr>
            <td class="cell" id="cell-5-0"></td>
            <td class="cell" id="cell-5-1"></td>
            <td class="cell" id="cell-5-2"></td>
            <td class="cell" id="cell-5-3"></td>
            <td class="cell" id="cell-5-4"></td>
            <td class="cell" id="cell-5-5"></td>
            <td class="cell" id="cell-5-6"></td>
            <td class="cell" id="cell-5-7"></td>
          </tr>
          <tr>
            <td class="cell" id="cell-6-0"></td>
            <td class="cell" id="cell-6-1"></td>
            <td class="cell" id="cell-6-2"></td>
            <td class="cell" id="cell-6-3"></td>
            <td class="cell" id="cell-6-4"></td>
            <td class="cell" id="cell-6-5"></td>
            <td class="cell" id="cell-6-6"></td>
            <td class="cell" id="cell-6-7"></td>
          </tr>
          <tr>
            <td class="cell" id="cell-7-0"></td>
            <td class="cell" id="cell-7-1"></td>
            <td class="cell" id="cell-7-2"></td>
            <td class="cell" id="cell-7-3"></td>
            <td class="cell" id="cell-7-4"></td>
            <td class="cell" id="cell-7-5"></td>
            <td class="cell" id="cell-7-6"></td>
            <td class="cell" id="cell-7-7"></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="message-container" id="message-container">
      <div class="message" id="message"></div>
    </div>
  </div>
  <div class="container-center">
    <div class="score-labels">
      <div class="score-label black-label" id="black-label">Black: <span id="black-score"></span></div>
      <div class="score-label white-label" id="white-label">White: <span id="white-score"></span></div>
    </div>
    <div class="score-bars">
      <div class="score-bar black-bar" id="black-bar"></div>
      <div class="score-bar white-bar" id="white-bar"></div>
    </div>
    <div class="reset-container">
      <button class="button" id="reset">Reset</button>
    </div>
  </div>
  <div class="start-container" id="start-container">
    <div class="start-overlay"></div>
    <div class="start-content">
      <div class="start-title">REVERSI</div>
      <p class="start-p">
        <span class="start-p-span">Black:</span>
        <label><input type="radio" name="black" checked>YOU</label>
        <label><input type="radio" name="black">CPU</label>
      </p>
      <p class="start-p">
        <span class="start-p-span">White:</span>
        <label><input type="radio" name="white" checked>YOU</label>
        <label><input type="radio" name="white">CPU</label>
      </p>
      <p class="start-p">
        <button class="button" id="start">Start</button>
      </p>
    </div>
  </div>
</div>
<style>
.container {
  background-color: #ddd;
  box-shadow: 2px 2px 4px #222;
  margin: 0 auto;
  padding: 20px 0;
  position: relative;
  width: 640px;
}

.container-center {
  margin: 0 auto;
  position: relative;
  width: 447px;
}

.message-container {
  display: none;
  height: 100%;
  position: absolute;
  top: 0;
  width: 100%;
}

.message {
  background-color: #ddd;
  box-shadow: 2px 2px 4px #222;
  line-height: 90px;
  margin: 40% auto 0;
  opacity: .9;
  text-align: center;
  width: 50%;
}

.board {
  background-color: #080;
  border: solid 1px #000;
  box-shadow: 2px 2px 4px #222;
}

.board-cells {
  border-collapse: collapse;
  margin: 10px;
}

.cell {
  height: 50px;
  width: 50px;
}

.valid {
  background-color: #f88;
  cursor: pointer;
}

.valid:hover {
  background-color: #faa;
}

.stone {
  border-radius: 50%;
  box-sizing: border-box;
  box-shadow: 2px 2px 4px #222;
  height: 100%;
  margin: auto;
  transition: width .2s 0s linear, background-color 0s .2s linear;
  width: 100%;
}

.black,
.black-label,
.black-bar {
  background-color: #000;
}

.white,
.white-label,
.white-bar {
  background-color: #fff;
}

.turn-effect {
  width: 0;
}

.score-labels {
  font-size: 0;
  margin: 10px 0;
}

.score-label {
  box-shadow: 2px 2px 4px #222;
  box-sizing: border-box;
  display: inline-block;
  font-size: 16px;
  padding: 5px 0;
  text-align: center;
  width: 30%;
}

.black-label {
  border: solid 2px #000;
  color: #fff;
}

.white-label {
  border: solid 2px #fff;
  color: #000;
  margin-left: 40%;
}

.turn {
  border: solid 2px #d22;
  color: #d22;
}

.score-bars {
  font-size: 0;
}

.score-bar {
  box-shadow: 2px 2px 4px #222;
  display: inline-block;
  height: 38px;
  transition: width .4s 0s ease;
}

.reset-container {
  margin-top: 10px;
  text-align: center;
}

.start-container {
  height: 100%;
  position: absolute;
  top: 0;
  width: 100%;
}

.start-overlay {
  background-color: #ddd;
  height: 100%;
  opacity: .6;
  position: absolute;
  width: 100%;
}

.start-content {
  background-color: #eee;
  box-shadow: 2px 2px 4px #222;
  margin: 25% auto 0;
  overflow: auto;
  position: relative;
  width: 50%;
}

.start-title {
  background-color: #080;
  color: #ddd;
  font-size: 2em;
  padding: 10px 0;
  text-align: center;
}

.start-p {
  text-align: center;
}

.start-p-span {
  display: inline-block;
  width: 55px;
}

.button {
  background-color: #080;
  border: none;
  color: #ddd;
  cursor: pointer;
  font-size: 16px;
  height: 38px;
  outline: none;
  width: 30%;
}

.button:hover {
  background-color: #0a0;
}
</style>
<script>
  let blackIsYou = true;
let whiteIsYou = true;
let isBlackTurn = true;

const getCellElement = function(row, col) {
  return document.getElementById('cell-' + row + '-' + col);
};

const addStone = function(row, col, className) {
  const cell = getCellElement(row, col);
  const stone = document.createElement('div');
  stone.classList.add('stone');
  stone.classList.add(className);
  cell.appendChild(stone);
};

const hasClass = function(element, className) {
  for(let i = 0; i < element.classList.length; i++) {
    if(element.classList[i] === className) {
      return true;
    }
  }
  return false;
};

const removeClassAll = function(className) {
  const elements = document.getElementsByClassName(className);
  for(let i = elements.length; i > 0; i--) {
    elements[i - 1].classList.remove(className);
  }
};

const isMyStone = function(cell) {
  if((isBlackTurn && hasClass(cell.children[0], 'black')) ||
     (!isBlackTurn && hasClass(cell.children[0], 'white'))) {
    return true;
  }
  return false;
};

const isValidLine = function(row, col, addRow, addCol) {
  let rowCount = addRow;
  let colCount = addCol;
  for(let i = 0; i < 7; i++) {
    const cell = getCellElement((row - rowCount), (col - colCount));
    if(!cell || !cell.children.length) {
      return false;
    }
    if(isMyStone(cell)) {
      if(rowCount === addRow && colCount === addCol) {
        return false;
      } else {
        return true;
      }
    }
    rowCount = rowCount + addRow;
    colCount = colCount + addCol;
  }
  return false;
};

const isValidCell = function(row, col) {
  if(isValidLine(row, col, -1, -1) ||
     isValidLine(row, col, -1, 0) ||
     isValidLine(row, col, -1, 1) ||
     isValidLine(row, col, 0, -1) ||
     isValidLine(row, col, 0, 1) ||
     isValidLine(row, col, 1, -1) ||
     isValidLine(row, col, 1, 0) ||
     isValidLine(row, col, 1, 1)) {
    return true;
  }
};

const turnStones = function(cells) {
  for(let i = 0; i < cells.length; i++) {
    const cell = document.getElementById(cells[i]);
    if(isBlackTurn) {
      cell.children[0].classList.remove('white');
      cell.children[0].classList.add('black');
      cell.children[0].classList.add('turn-effect');
      setTimeout(function() {
        cell.children[0].classList.remove('turn-effect');
      }, 200);
    } else {
      cell.children[0].classList.remove('black');
      cell.children[0].classList.add('white');
      cell.children[0].classList.add('turn-effect');
      setTimeout(function() {
        cell.children[0].classList.remove('turn-effect');
      }, 200);
    }
  }
};

const turnLineStones = function(row, col, addRow, addCol) {
  let rowCount = addRow;
  let colCount = addCol;
  let cells = [];
  for(let i = 0; i < 7; i++) {
    const cell = getCellElement((row - rowCount), (col - colCount));
    if(!cell || !cell.children.length) {
      return;
    }
    if(isMyStone(cell)) {
      if(rowCount !== addRow || colCount !== addCol) {
        turnStones(cells);
      }
      return;
    }
    cells.push(cell.id);
    rowCount = rowCount + addRow;
    colCount = colCount + addCol;
  }
  return;
};

const turnAllStones = function(row, col) {
  turnLineStones(row, col, -1, -1);
  turnLineStones(row, col, -1, 0);
  turnLineStones(row, col, -1, 1);
  turnLineStones(row, col, 0, -1);
  turnLineStones(row, col, 0, 1);
  turnLineStones(row, col, 1, -1);
  turnLineStones(row, col, 1, 0);
  turnLineStones(row, col, 1, 1);
};

const searchValidCells = function() {
  for(let row = 0; row < 8; row++) {
    for(let col = 0; col < 8; col++) {
      const cell = getCellElement(row, col);
      if(cell.children.length) continue;
      if(isValidCell(row, col)) {
        cell.classList.add('valid');
      }
    }
  }
};

const updateScore = function() {
  const black = document.getElementsByClassName('black');
  const white = document.getElementsByClassName('white');
  const all = black.length + white.length;
  const blackRatio = black.length * 100 / all;
  const whiteRatio = white.length * 100 / all;
  document.getElementById('black-score').innerText = black.length;
  document.getElementById('white-score').innerText = white.length;
  document.getElementById('black-bar').style.width = blackRatio + '%';
  document.getElementById('white-bar').style.width = whiteRatio + '%';
};

const showMessageNoPlace = function() {
  if(isBlackTurn) {
    document.getElementById('message').innerText = "Black can't put.";
  } else {
    document.getElementById('message').innerText = "White can't put.";
  }
  document.getElementById('message-container').style.display = 'block';
};

const isTheEnd = function() {
  const stones = document.getElementsByClassName('stone');
  if(stones.length === 8 * 8) {
    return true;
  }
  const black = document.getElementsByClassName('black');
  if(black.length === 0) {
    return true;
  }
  const white = document.getElementsByClassName('white');
  if(white.length === 0) {
    return true;
  }
};

const endGame = function() {
  document.getElementById('white-label').classList.remove('turn');
  document.getElementById('black-label').classList.remove('turn');
  const black = document.getElementsByClassName('black');
  const white = document.getElementsByClassName('white');
  if(black.length > white.length) {
    document.getElementById('message').innerText = 'Black win.';
  } else if(black.length < white.length) {
    document.getElementById('message').innerText = 'White win.';
  } else {
    document.getElementById('message').innerText = 'Draw.';
  }
  document.getElementById('message-container').style.display = 'block';
};

const clickCorner = function(elements) {
  for(let i = 0; i < elements.length; i++ ) {
    const splitedId = elements[i].id.split('-');
    if(splitedId[1] === '0' && splitedId[2] === '0' ||
       splitedId[1] === '0' && splitedId[2] === '7' ||
       splitedId[1] === '7' && splitedId[2] === '0' ||
       splitedId[1] === '7' && splitedId[2] === '7') {
      elements[i].click();
      return true;
    }
  }
  return false;
};

const clickCpu = function(elements) {
  if((isBlackTurn && !blackIsYou) || (!isBlackTurn && !whiteIsYou)) {
    if(!clickCorner(elements)) {
      elements[Math.floor(Math.random() * elements.length)].click();
    }
  }
};

const updateTurnLabels = function() {
  if(isBlackTurn) {
    document.getElementById('white-label').classList.remove('turn');
    document.getElementById('black-label').classList.add('turn');
  } else {
    document.getElementById('black-label').classList.remove('turn');
    document.getElementById('white-label').classList.add('turn');
  }
};

const updateTurnSecond = function(updateBlack) {
  isBlackTurn = updateBlack;
  updateTurnLabels();
  searchValidCells();
  const elements = document.getElementsByClassName('valid');
  if(elements.length === 0) {
    showMessageNoPlace();
    setTimeout(function() {
      endGame();
    }, 2000);
  } else {
    clickCpu(elements);
  }
};

const updateTurn = function(updateBlack) {
  isBlackTurn = updateBlack;
  updateTurnLabels();
  searchValidCells();
  const elements = document.getElementsByClassName('valid');
  if(elements.length === 0) {
    showMessageNoPlace();
    setTimeout(function() {
      document.getElementById('message-container').style.display = '';
      updateTurnSecond(!isBlackTurn);
    }, 2000);
  } else {
    clickCpu(elements);
  }
};

const addInitStones = function() {
  addStone(3, 3, 'white');
  addStone(3, 4, 'black');
  addStone(4, 3, 'black');
  addStone(4, 4, 'white');
};

const init = function() {
  blackIsYou = true;
  whiteIsYou = true;
  addInitStones();
  updateScore();
  updateTurn(true);
  document.getElementById('start-container').style.display = '';
};

const onClickCell = function() {
  if(!hasClass(this, 'valid')) return;
  removeClassAll('valid');
  const splitedId = this.id.split('-');
  if(isBlackTurn) {
    addStone(splitedId[1], splitedId[2], 'black');
  } else {
    addStone(splitedId[1], splitedId[2], 'white');
  }
  turnAllStones(splitedId[1], splitedId[2]);
  updateScore();
  setTimeout(function() {
    if(isTheEnd()) {
      endGame();
      return;
    }
    updateTurn(!isBlackTurn);
  }, 400);
};

const onClickReset = function() {
  document.getElementById('message-container').style.display = '';
  removeClassAll('valid');
  const stones = document.getElementsByClassName('stone');
  for(let i = stones.length; i > 0; i--) {
    const parent = stones[i - 1].parentNode;
    parent.removeChild(stones[i - 1]);
  }
  init();
};

const onClickStart = function() {
  const black = document.getElementsByName('black');
  if (black[0].checked) {
    blackIsYou = true;
  } else {
    blackIsYou = false;
  }
  const white = document.getElementsByName('white');
  if (white[0].checked) {
    whiteIsYou = true;
  } else {
    whiteIsYou = false;
  }
  document.getElementById('start-container').style.display = 'none';
  updateTurn(true);
};

const addEvents = function() {
  const cells = document.getElementsByClassName('cell');
  for(let i = 0; i < cells.length; i++) {
    cells[i].addEventListener('click', onClickCell, false);
  }
  const reset = document.getElementById('reset');
  reset.addEventListener('click', onClickReset, false);
  const start = document.getElementById('start');
  start.addEventListener('click', onClickStart, false);
};

window.onload = function() {
  addEvents();
  init();
};
</script>
